<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="description" content="This is the best Visual Basic Tutorial that teach beginners to create their own computer programs instantly!">
<meta name="keywords" content="Visual Basic, Visual Basic 6, Visual Basic 6.0, vb code, vb6, vb, vb net,visual basic code,visual basic net,Visual Basic Tutorial,Visual Basic 6 tutorial,Visual Basic Lessons,learn Visual Basic, Visual Basic Help,Visual Basic 2005,Visual Basic 2008,VBA,VisualBasic 6 ">
<meta name="Author" content="Dr.Liew Voon Kiong">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="icon" href="vb.ico" type="image/x-icon" />
<title>Creating Report in Visual Basic</title>

<style type="text/css">
body {text-align:center.............................................................}
#container
{
width: 90%;
margin: auto;
background-color: #fff;
color: #333;
border:  gray;
line-height: 130%;}
</style></head>
<body>
<div id="container">



<body style="position: absolute; float: left" topmargin="0" leftmargin="100" rightmargin="100" bottommargin="11" marginwidth="0" marginheight="1">

<h2 align="center"><font face="Verdana">Lesson 40 : Creating  Reports in Visual Basic 6</font><p align="center">

<form action="http://www.google.com/cse" id="cse-search-box">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3033628290023372:qcuupp5p6hx" />
    <input type="hidden" name="ie" value="ISO-8859-1" />
    <input type="text" name="q" size="31" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>

<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
</p>
<p align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-3033628290023372";
/* 728x15, created 1/3/10 */
google_ad_slot = "4418197155";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
<font face="Verdana">
<h2>
<table border="1" width="100%" id="table3" cellspacing="0" cellpadding="0">
	<tr>
		<td valign=top BGCOLOR="#151333">&nbsp;<script type="text/javascript"><!--
google_ad_client = "pub-3033628290023372";
/* 160x600, created 1/3/10 */
google_ad_slot = "8328722891";
google_ad_width = 160;
google_ad_height = 600;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script><p align=center><script type="text/javascript"><!--
google_ad_client = "pub-3033628290023372";
/* 160x600, created 1/3/10 */
google_ad_slot = "8328722891";
google_ad_width = 160;
google_ad_height = 600;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p></td>

</font>
		<td valign=top width="730">
	

		
		

<table border="0" width="99%" id="table8">
<brp><p align="left"><font color="#000000" face="Arial"><b>40</b></font><font face="Verdana"><b><font color="#000000" face="Arial">.1 A brief introduction to reporting tool in Visual basic 6</font></b></p>
	

		
		

</font>
				<p align="left"><font face="Arial" size="2">You have learned how to build a database in Visual Basic 6 in previous chapters, however you have not learned how to display the saved data in a report. </font><font face="Verdana">
	

		
		

		<font size="2" face="Verdana">
<font size="2" face="Arial">
				R<font size="2">eports are important and useful in many respects because they provide useful and meaningful information concerning a set of data. In this chapter, we will show you how to create a report in Visual Basic 6.</font></font></font></font></p><p align="left"><font size="2" face="Arial">In previous versions of Visual Basic 6, there is no&nbsp; primary reporting . Previous versions of Visual basic 6 uses Crystal Reports tool, a software from Seagate. Fortunately,&nbsp; Microsoft has integrated a good report writer into Visual Basic 6, so you no longer need to use Crystal Report.</font><font face="Verdana"><font size="2" face="Verdana"></p>

		</brp>
			<tr>
				<td valign=top>&nbsp;<script type="text/javascript"><!--
google_ad_client = "pub-3033628290023372";
/* 336x280, created 1/3/10 */
google_ad_slot = "0106079886";
google_ad_width = 336;
google_ad_height = 280;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></td>

		</font>
				<td valign=top><brp><p align="left"></brp>

</font>
					<b><font color="#000000" face="Arial">40.2 Steps in building your report in Visual Basic 6</font></b><p align="left"><font face="Arial" color="#000000" size="2">Visual Basic 6 provides you with a <b>data report designer </b>&nbsp;to create your report, it is somewhat similar to data report designer in Microsoft Access. The <b>data report designer </b>has its own set of controls which allow you to customize your report seamlessly. The&nbsp; steps in creating the report in VB6 are listed below:</font><p align="left"><b><font face="Arial" color="#000000" style="font-size: 11pt">Step 1: Adding Data Report</font></b><p align="left"><font face="Arial" size="2" color="#000000">Start Visual Basic as a Standard EXE project. From the <b>Project</b> menu in the VBE, select <b>Add Data Report</b> in the dropdown menu. Now, you will be presented with the data report environment, as shown in Figure 40.1. The data report environment contains 6 controls, they are </font><font face="Arial" size="2">RptTextBox, RptLine, RptFunction, RptLabel, RptImage and RptShape.</font><p align="left"><font face="Arial" size="2">You can customize your report here by adding a title to the page header using the report label RptLabel. Simply drag and draw the RptLabel control on the data report designer window and&nbsp; use the Caption property to change the text that should be displayed. </font>
</font><font face="Arial" size="2">You can also add graphics to the report using the RptImage control. </font>
</td>
			</tr>
		</table>

		<font face="Verdana">

		<font face="Verdana">

		<font face="Verdana">

		<p align="justify"><img border="0" src="Images/chapter40_1.jpg" width="730" height="488"></p>
</font>

		</font>
		</font></font><p><b><font face="Arial" size="2">Figure 40.1: The Data Report Environment</font></b></p>
		<font face="Verdana">

		<font face="Arial">
		<p align="justify"><span style="font-size: 11pt"><b>Step 2: Connecting the report to database using&nbsp; Data Environment Designer </b></span>
		</font></p>
		<font face="Arial" size="2">Click the <b>Project</b> menu, then select <b>Data Environment</b>. 
		from the drop-down menu. The default data environment will appear, as shown in figure 40.2</font><p align="center"><font size="2" face="Verdana"><img border="0" src="Images/chapter40_2.jpg" width="634" height="206" align="left"></p>
<p>&nbsp;<p align="justify">&nbsp;</p><p align="justify">&nbsp;</p><p align="justify">&nbsp;</p><p align="justify">&nbsp;</p><p align="justify">&nbsp;</p><p align="justify">&nbsp;</p><p align="justify">&nbsp;</p>
		</font></font><font size="2" face="Arial"><p align="justify"><b>Figure 40.2: Data Environment</b></p><p align="justify">Now, to connect to the database, right-click <b>connection1 </b>and<b> </b>select&nbsp; <b>Microsoft Jet 3.51 OLE DB Provider</b>&nbsp; (as we are using MS Access database) from the <b>Data Link Properties</b> dialog (as shown in Figure 40.3),&nbsp; then click next. </p><p align="justify"><img border="0" src="Images/chapter40_3.jpg" width="367" height="467"></p><p align="justify"><b>Figure 40.3</b></p><p align="justify">Now, you need to connect to the database by selecting a database file from your hard disk. For demonstration purpose, we will use the database&nbsp; <b>BIBLIO.MDB </b>that comes with Visual Basic, as shown in Figure 40.4. The path to this database file is C:\Program Files\Microsoft Visual Studio\VB98\BIBLIO.MDB. This path varies from computers to computers, depending on where you install the file. After selecting the file, you need to test the connection by clicking the <b>Test Connection</b> button at the right bottom of the Data Link Properties dialog. If the connection is successful, a message that says 'Test Connection Succeeded' will appear. Click the OK button on the message box to return to the data environment. Now you can rename connection1 to any name you like by right-clicking it. For example, you can change it to MyConnection. You may also change the name of DataEnvironment1 to MyDataEnvironment using the Properties window.</p><p align="justify"><img border="0" src="Images/chapter40_4.jpg" width="367" height="467"></p><p align="justify"><b>Figure 40.4</b></p>
		</font><font face="Arial" style="font-size: 11pt"><p align="justify"><b>Step 3: Retrieving Information from the Database</b></p>
		</font><font size="2" face="Arial"><p align="justify">In order to use the database in your report, you need to create query to retrieve the information from the database. Here , we will use SQL command to create the query. First of all, right click on MyConnection to add a command to the data environment. The default command is Command1, you can rename it as MyCommand, as shown in Figure 40.5.</p><p align="justify"><img border="0" src="Images/chapter40_5.jpg" width="642" height="370"></p><p align="justify"><b>Figure 40.5: MyCommand </b></p><p align="justify">In order to use SQL command, right-click MyCommand and you can see its properties dialog. At the General tab, select SQL statement and key in the following SQL statement:</p>
<blockquote>
		<blockquote>
				<p align="justify"><b>SELECT Au_ID, Author<br>
				FROM Authors ORDER BY Author</b></p>
		</blockquote>
</blockquote>
<p align="justify">This command is to select all the fields from the <b>Authors</b> table in the <b>Biblio.Mdb</b> database. The command ORDER BY Author is to arrange the list in ascending order according to the Authors' Names.</p>
		<p align="left">Now, you need to customize a few properties of your data report so that it can connect to the database. The first property to set is the DataSource, set it to MyDataEnvironment</font><font size="2" face="Verdana">.
		</font><font face="Arial" size="2">Next, you need to set the DataMember property to MyCommand,as shown in Figure 40.6</font></p><p align="left"><img border="0" src="Images/chapter40_6.jpg" width="230" height="370"></p><p align="left"><b><font face="Arial" size="2">Figure 40.6: Properties of </font></b></p><p align="left"><font face="Arial" size="2">To add&nbsp; data to your report, you need to drag the fields from MyCommand in MyDataEnvironment into MyDataReport, as shown in Figure 40.7.Visual Basic 6 will automatically draw a RptTextBox, along with a RptLabel control for each field on the report. You can customize the look of the labels as well as the TextBoxes from the properties window of MyDataReport.</font></p><p align="left"><img border="0" src="Images/chapter40_7.jpg" width="702" height="428"></p><p align="left"><b><font face="Arial" size="2">Figure 40.7</font></b></p><p align="left"><font face="Arial" size="2">The Final step is to set MydataReport as the Startup form from the Project menu, then run the program. You will see your report as shown in Figure 40.8. You can print out your report.</font></p><p align="left"><img border="0" src="Images/chapter40_8.jpg" width="518" height="600"></p><p align="left"><font face="Arial" size="2"><b>Figure 40.8: The Final Report.</b></font></p>
<p align="left" class="MsoNormal"><font size="2">
<span style="font-family: Verdana">
Congratulation! You have finish reading all the 39 lessons, and now you can consider yourself a VB programmer. You should consider buying the <b>TEXTBOOK</b> 
for this tutorial for easy referencing in the future. Buy this book by clicking the picture below:</span></font></p>
<p align="left">&nbsp;<p align="left" class="MsoNormal">&nbsp;<form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="2733312">
<p align="center">
<input type="image" src="vbbook.jpg" border="0" name="submit" alt="PayPal - The safer, easier way to pay online.">
<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</p>
</form>
</p>
</p>
		<font face="Verdana">
		<font size="2" face="Verdana">
<table border="0" width="100%" id="table9">
	<tr>
		<td>&nbsp;&nbsp;</td>
</font>
		<td>
		<font face="Verdana">
		</td>
	</tr>
</table>
<font size="2" face="Arial">
		<p align="center"><script type="text/javascript"><!--
google_ad_client = "pub-3033628290023372";
/* 728x15, created 1/3/10 */
google_ad_slot = "4418197155";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p>
		</font>
		<div align="center">
		
		
<center>
<b>
&nbsp;<a href="lesson39.html">&lt;Previous Lesson&gt;</a>
<a href="vbtutor.html">&lt;&lt;</a><font face="Arial"><font face="Verdana"><a href="vbtutor.html">Home&gt;&gt;</a>
</font></font></b></center></td>
	</tr>
	<tr>
		<td valign=top BGCOLOR="#151333">&nbsp;</td>
		<td valign=top width="730">
	

		
		

		&nbsp;</td>
	</tr>
</table>

<p align="left"><br>
&nbsp;</p>
<font size="2" face="Arial">

</font>
</div>

</font>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-3249832-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>

</html>